# Disclaimer
Even though I work on vRealize Network Insight at VMware, this book has been written on a personal title. Any opinions expressed here are my own and not per se the opinion of VMware.

The publisher and the author are providing this book and its contents on an "as is" basis and make no representations or warranties of any kind with respect to this book or its contents. The publisher and the author disclaim all such representations and warranties, including but not limited to warranties of healthcare for a particular purpose. In addition, the publisher and the author assume no responsibility for errors, inaccuracies, omissions, or any other inconsistencies herein.

This disclaimer is provided simply because someone, somewhere, will ignore this disclaimer. If they then do experience problems or a "resume generating event", they have no one to blame but themselves. Don’t be that person!

# Introduction

Thank you for purchasing the vRealize Network Insight Cookbook! This book is for people in jobs or interests related to networking and security in private, hybrid, and public clouds. Managing these networks and security policies becomes a much easier job with Network Insight, and this book will try to explain best how to go about managing those networks and how Network Insight itself is positioned to do so.

Sometimes it's not all in the name. This is also true for vRealize Network Insight, as it gives you not just insight into your network, but your compute, storage, and network layers.

I> While the full product name is VMware vRealize® Network Insight™ and VMware vRealize® Network Insight™ Cloud for the Software-as-a-Service version; please note that I'll be using the shorthand 'Network Insight' from now on.

With Network Insight, you can take the guesswork out of deploying micro-segmentation with comprehensive network flow analytics to map out real-time traffic and model security groups and firewall rules to successfully implement micro-segmentation security policies. It also helps to improve the performance and availability of the infrastructure by combining and correlating virtual and physical compute, storage, and networking components to provide a clear and full picture of the infrastructure.

It does not discriminate between virtual machines or physical servers, provides detailed information about the smallest workloads (containers), has integrations with the VMware Virtual Cloud Network vision and everything that runs beneath the Virtual Cloud Network.

Network Insight collects data from data sources like VMware vSphere, VMware NSX, Physical network devices (switches, routers, load balancers, and firewalls), Physical converged systems, IPAM systems, and log collectors. All this information is put in a structured database, correlated, and available via the intuitive user interface and API. The way this converged information is presented in the user interface is what makes Network Insight unique and such a pleasure to work with.

It's all about the fundamentals of the platform, as it's designed from the ground up to be as open as possible. This means you can retrieve any, and all the data that is gathered and do all kinds of neat things with it like filtering, grouping, sorting, and perform other modifiers on it (more on that in the chapter [Using the Search Engine](#ch-search).

Apart from configuration and operational data, you can also send real-time network flow (NetFlow or sFlow) data to Network Insight to map out which workloads in your environment talk to each other. Because all data is correlated, the network flow data is linked to the source or destination workload (virtual machine or physical host), and you can see the name of the workload related to the flow, instead of just seeing that **10.0.0.10** talks to **10.0.1.11** over port **80**.

I> **Configuration data** is meant as the configuration of the data source (i.e., show running-configuration on a physical Cisco device and the inventory of a VMware vCenter, etc.). **Operational data** is meant as dynamic, changing data on data sources (i.e., the route and mac tables on a network device, IP addresses of virtual machines, etc.).

This network flow data is typically generated by the vSphere Distributed Switch, the NSX Distributed Firewall components, or a physical network device.

Due to the technical and sometimes very specific nature of this book, it's advised to have a Network Insight instance ready to go while you are reading; so, you can try things out with data from your infrastructure!

The content of this book is based on Network Insight 5.0 (with some small nuggets on 5.1 because I took too long to write it). Considering the product team is an innovation engine and moves really quickly (delivers major features every three months), you need to doublecheck the details when you're using a newer version. This book also does not intend to replace the [official documentation](https://docs.vmware.com/en/VMware-vRealize-Network-Insight/index.html), but rather complement it. The specific technical details in this book will age, and rightly so.

{pagebreak}

{width: 40%, caption: "Meet Fred, the vRealize Network Insight Mascot"}
![](images/ch-1/vrni-sticker-fred-baby-yoda-onesie-light-skinned.png)

{pagebreak}

{id: book-updates}
## Book Updates

This is a so-called 'Agile' book. As Network Insight evolves and new features are added (and existing features are changed), this book will try to keep up with the release cycles. That's what so great about Leanpub, as you purchase this book once, and every time I push an update, you will get the updated version for free.

To get notified whenever a new version of this book launches, I strongly recommend that you allow Leanpub to send you update emails. These notifications are not turned on by default; please make sure you do this:

1. Log into your [Leanpub](https://leanpub.com/login) account
2. Select "Library" from your account menu (upper-right)
3. Click on this book’s cover image
4. Select "New Version Available" under "Email Settings"

If you’re reading this on a Kindle, you can add your Kindle email address. That way, Leanpub will send new versions right to your Kindle.

{sample: true}
## How to Use This Book
As the book title suggests, this book acts as a cookbook for Network Insight. It will provide context and background information on the Network Insight features, and explain how to use them. I hope that you can use it for two goals:

1) Use the book to get you started with learning Network Insight if you're new to the product.
2) Use it as a reference guide while working with Network Insight in your day to day operations.

There is a ton of technical information here, including automation code, call out tips and tricks, key points, and more. To make sure you get the most out of it, I'd like to cover a few conventions that I'll use in this book.

**Bold**
: Used for essential bits of information that will come back in the following text, or that is referenced in an image.

[Links](#)
: Throughout this book, there will be links to external resources, but also internal links to other chapters. Although I've tried to keep each chapter standing on its own, there will be call outs to previous chapters to refresh your memory.

I> This is a call-out box. It'll contain either a tip or trick based on the previous text or an important call-out to summarize the previous text. In any case, I'd like you to remember these call-outs.

W> This is a 'key tip' call-out box. It'll contain a descriptive way to access a 'hidden' feature of Network Insight.

**Search queries**
There are many search query examples throughout this book. These search queries look like this:
{line-numbers: false}
```
VMs where vCenter = myvc
```

**Command Prompt Output**
Executing commands on Network Insight, or executing an automation script has output. To show examples of these outputs, there are some command prompt outputs throughout this book. Here's an example:
{format: console, line-numbers: false}
```
PS ~/> ./example.ps1
Counting from 1 to 9 (in seconds):  1 2 3 4 5 6 7 8 9
PS ~/>
```

**Code Examples**
Mostly confined to the [Automating Network Insight chapter](#ch-automating), there will also be example code. Here's how that will look:
{format: python}
```
x = 1
if x == 1:
  # indented four spaces
  print("x is 1.")
```

{sample: false}
## Comments and Questions
While I have tested and verified the information, examples, and external (and internal) links within this book extensively, there is a chance that something has changed in Network Insight, making the instructions not match anymore. You might also find that something is broken. Please let me know of any errors you find, as well as your suggestions for making this book better, by contacting me on twitter [\@smitmartijn](https://twitter.com/smitmartijn). There are also more of my other contact details that are on my blog at <https://lostdomain.org>

{sample: false}
## Acknowledgements

This book wouldn't be possible without the amazing team behind Network Insight. From providing me with insights into what's going on behind the scenes to putting up with my excessive stream of questions, these people stood by me and have credit in making this book happen. Let me introduce them:

[Shiv Agarwal](https://www.linkedin.com/in/agarwalshiv/)
: VP/GM at VMware for vRealize Network Insight, Co-founder ArkinNet. One of the most driven and collaborative persons I've met.

[Abhijit Sharma](https://www.linkedin.com/in/abhijitsharma71/)
: Senior Staff Engineer at VMware, Co-founder ArkinNet. One of the smartest persons I've met.

[Rohit Reja](https://www.linkedin.com/in/rohit-reja-1b11335/)
: Staff Engineer at VMware. Master of Search and API. Original ArkinNet crew.

[Manish Virat](https://www.linkedin.com/in/manishvirat/)
: VP of Engineering at Numerator. Previously the ruler of the Collector and Data Sources.

[Karthic Kumar](https://www.linkedin.com/in/karthicobla/)
: Technical Product Manager at VMware. Karthic's picture is in the dictionary under *Customer Focused*.

[Dave Overbeek](https://www.linkedin.com/in/david-overbeek-2a772a1/)
: Director of Technical Marketing at VMware. Supporter extraordinaire always manages to push me in the right direction.

[Naveen Chaudhary](https://www.linkedin.com/in/naveen-chaudhary-6b5a2991/)
: Senior Technical Support at VMware. A real-life Network Insight dictionary.

[Taruna Gandhi](https://www.linkedin.com/in/tarunagandhi/)
: Director of Marketing at VMware. Idea generator extraordinaire.

This is not everybody; the entire vRealize Network Insight team had a hand in this work. Thank you for your support and for putting up with my continuous stream of questions.

{sample: false}
## Respect the Author’s Rights
This book is available on [Leanpub](https://leanpub.com/networkinsight) and is not restricted by Digital Rights Management (DRM). That means that you can buy once and read it on any device and in any format that you'd like. It also means that, in theory, the book can be passed along to other people. To support further development of the book, I'll ask you to forward people to <https://leanpub.com/networkinsight> to buy their own copy. Help me help you, thanks!

{sample: true}
# Foreword by Shiv Agarwal

*Founder of ArkinNet, currently VP and GM of vRealize Network Insight with VMware*

VMware vRealize Network Insight (or vRNI, or Network Insight) has seen massive adoption in VMware's' customer base, helping our customers get end-to-end visibility and operational simplicity as they embrace a software-defined approach to networking and security. Network Insight completes VMware's Virtual Cloud Network vision and story by providing seamless visibility and converged network operations across the data center (virtual and physical) and hybrid cloud as well as branch offices and remote sites (via SD-WAN integration).

Jogging down the memory lane, Network Insight came into VMware through the Arkin (ArkinNet) acquisition. As it happens so often in Silicon Valley, my co-founder and I were at VMware before we went out and started Arkin (in 2013). We had joined VMware (in 2008) as part of the Blue Lane acquisition. At Blue Lane, we had built a virtual firewall which became the first-generation virtual firewall (VMware NSX DFW) inside VMware. During our first tenure at VMware (2008-2013), NSX was in its infancy.

We saw enterprise customers struggling to operate their virtual networking stack. They were trying to use their existing legacy processes and toolset. Their people's mindset was geared and tuned to managing physical networks. Virtualization was new to the network operators. That's when my co-founder and I got the idea of starting Arkin. You start a company with a big vision, and ours was to transform how networks are operated. The idea was to bring consumer-grade simplicity to managing networks. We wanted to challenge the status quo.

Our first set of use cases was to help customers implement micro-segmentation and operationalize NSX. NSX was becoming the dominant network virtualization stack, and we betted on it. We got the first product out in 18 months with some of the marquee NSX customers using it in production and were acquired by VMware in 36 months. At VMware, it was like a match made in heaven. Thanks to the NSX sales team, the two products together (NSX and Network Insight) started flying off the shelf! It's been fun! I tell my team often that the acquisition by VMware was a little pit stop in our journey, which, at the time of writing this foreword, is continuing.

We continue to build. Network Insights expanded charter and scope now includes end-to-end network operations - monitoring, troubleshooting, and optimization. By combining the different types of network data (flows, metrics, config, and more), we have provided a unique platform for our customers to converge their traditionally silo-ed visibility and realize a multitude of use cases around next-generation networking and security. We have also created a unique advantage for ourselves by adding a strong application context to network and security datasets. Applications are the lifeline of an enterprise, and Network Insight's powerful application discovery and planning feature enables our customers to see their network and security data through the lens of their applications. We are thus elevating IT and empowering them to have a more business-oriented conversation with their line of businesses.

Over the next few years, we see the operational silos breaking at a rapid pace and a lot of automation happening, ultimately leading to self-driving networks. That's the future. Silos create inefficiency and finger-pointing. Our vision is to bring a high degree of efficiency in network operations through convergence, consumer-grade experience, and analytical insights. We continue to deliver upon our vision by investing in new areas. Recently, we acquired a company, Veriflow, which has pioneered the area of network verification in software. This technique is used in many mission-critical industries where failure can be catastrophic such as airlines and space. Networking is mission-critical for our customers. With this acquisition, we are arming our customers with network modeling and prediction and significantly push the frontier of network operations in the enterprises.

I am thrilled and excited to be writing this foreword for Martijn's book on VMware vRealize Network Insight. Martijn has been the technical face and flag bearer of Network Insight in the EMEA region for a long time, even since before the acquisition. I hope the insights captured in this book triggers a genuine thought about transforming their network and security operations in the mind of its readers.

{sample: false}
# About the Author

The first thought going through my head, after decided to write this book, is: why? Why on earth are you starting another big project that's going to take up a ton of time? The reason is simple: Hi, I'm Martijn Smit, and I'm an information-sharing addict (echo's: "hi Martijn!").

I'm proud to be Dutch and proud to be in the IT industry. My career started at a hosting company, in which I spent eight years moving from the web hosting help desk to colocation & dedicated server support to managing the internet-network and helping to build a new datacenter from the ground up. After this provider, I joined an integrator company, with which I spent five years designing and deploying data center infrastructures, including storage, compute, networking, and virtualization. I was also in the innovation group that brought the last two together to support virtual networking; Software-Defined Networking (SDN).

I currently work at VMware in Technical Marketing for vRealize Network Insight, as I wholeheartedly believe in the way Network Insight approaches network troubleshooting and monitoring and want to spread the word. My previous role was to guide customers to the world of virtual networking as a Networking & Security Solutions Engineer.

Apart from my passion for technology, I believe in a healthy balance and taking care of yourself, so often take 2 to 3-hour bike rides, exercise every day, and (try to) eat proper food. One of my favorite hobbies is spending time doing slow cooks on my Kamado barbecue. I also tear through books and have a goal to read at least 30 books yearly. I'm an information-sharing addict and mostly do so by giving talks and doing technical blogs. If you would like to see more of my rants, you can follow me on twitter on [\@smitmartijn](https://twitter.com/smitmartijn) or my blog at <https://lostdomain.org>

Back to this book; so, I have been dealing with the entire data center stack for years. One of the things that always annoyed me was that there was no right solution to troubleshoot and monitor that entire stack; it was still separate solutions for each layer. In 2014, I came across a company called ArkinNet, which had a fantastic product which could collect data from multiple layers (storage, compute, and networking) and holistically present it. After doing some due diligence, I immediately included Arkin into our product portfolio, and I've been in love with the product ever since.

ArkinNet was later acquired in June of 2016 by VMware, and it is now known as vRealize Network Insight.

Let's dive in!
